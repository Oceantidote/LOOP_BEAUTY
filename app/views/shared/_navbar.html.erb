<div class="offers-banner">
  <p class="offers-banner-text">FREE SAMPLES WITH EVERY ORDER</p>
</div>
<div class="navbar navbar-expand-sm navbar-light navbar-lewagon">
  <button id="navbar-toggler" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent,#mobile-nav-brands-menu,#mobile-nav-influencers-menu" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <%= image_tag 'hamburger.png', width: 25 %>
  </button>
  <div class="navbar-logo">
    <%= link_to homepage_path, class: "navbar-brand" do %>
      <%= image_tag 'loop-beauty-logo.svg' %>
    <% end %>
  </div>
  <div class="navbar-middle">
    <%= link_to brands_path do %>
      <p id="navbar-brands" class="navbar-middle-item <%= params[:controller] == 'brands' && params[:action] == 'index' ? 'navbar-active' : '' %>">Brands</p>
    <% end %>
    <%= link_to influencers_path do %>
      <p id="navbar-influencers" class="navbar-middle-item <%= params[:controller] == 'pages' && params[:action] == 'influencers' ? 'navbar-active' : '' %>">Influencers</p>
    <% end %>
    <%= link_to products_path do %>
      <p class="navbar-middle-item <%= params[:controller] == 'products' ? 'navbar-active' : '' %>">Make Up</p>
    <% end %>
    <%= link_to insider_path do %>
      <p class="navbar-middle-item <%= params[:controller] == 'pages' && params[:action] == 'insider' ? 'navbar-active' : '' %>">Insider</p>
    <% end %>
    <%= link_to videos_path do %>
      <p class="navbar-middle-item <%= params[:controller] == 'pages' && params[:action] == 'videos' ? 'navbar-active' : '' %>">Video</p>
    <% end %>
  </div>
  <ul class="navbar-nav">
    <div style="display: flex; align-items: center;">
      <li class="nav-item mobile-hidden">
        <%= link_to 'Follow', 'https://www.instagram.com/loop_beauty/', target: "_blank", class: "nav-link-normal" %>
      </li>
      <span class="mobile-hidden">|</span>
      <li class="nav-item mobile-hidden">
        <%= link_to 'Freebies', freebies_path, class: "nav-link-normal" %>
      </li>
    </div>
    <li class="nav-item mobile-hidden">
      <%= link_to '#', class: "nav-link" do %>
        <%= image_tag 'navbar-search.png' %>
      <% end %>
    </li>
    <li class="nav-item mobile-hidden">
      <%= link_to '#', class: "nav-link" do %>
        <%= image_tag 'navbar-user.png' %>
      <% end %>
    </li>
    <li class="nav-item basket-icon-container mobile-hidden">
      <%= link_to bag_path, class: "nav-link" do %>
        <%= image_tag 'navbar-basket.png' %>
      <% end %>
      <p class="basket-item-count basket-web"><%= @basket.basket_products.count %></p>
    </li>
  </ul>
  <div class="mobile-nav-links-container">
    <div class="mobile-left-links">
      <%= link_to '#', class: "" do %>
        <%= image_tag 'navbar-user.png' %>
      <% end %>
    </div>
    <div class="mobile-left-links" style="margin-left: 5px;">
      <%= link_to '#', class: "" do %>
        <%= image_tag 'navbar-basket.png' %>
      <% end %>
      <p class="basket-item-count basket-mobile"><%= @basket.basket_products.count %></p>
    </div>
  </div>
</div>
<div class="collapse navbar-collapse main-nav-dropdown" id="navbarSupportedContent">
  <ul class="navbar-nav mr-auto">
    <% if user_signed_in? %>
      <li class="nav-item ">
        <%= link_to "Home", "#", class: "nav-link" %>
      </li>
      <li class="nav-item">
        <%= link_to "Messages", "#", class: "nav-link" %>
      </li>
      <li class="dropdown">
        <%= image_tag 'navbar-user.png', class: "nav-link dropdown-toggle", id: "navbarDropdown", data: { toggle: "dropdown" }, 'aria-haspopup': true, 'aria-expanded': false %>
        <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
          <%= link_to "Action", "#", class: "dropdown-item" %>
          <%= link_to "Another action", "#", class: "dropdown-item" %>
          <%= link_to "Log out", destroy_user_session_path, method: :delete, class: "dropdown-item" %>
        </div>
      </li>
    <% else %>
      <!-- SHOWING ON MOBILE -->
      <li class="nav-item position-relative">
        <div class="dropdown-forward-container">
          <%= image_tag 'dropdown-forward.png', class: "dropdown-arrow" %>
        </div>
        <%= link_to "Brands", "#", id: "mobile-nav-brands", class: "nav-link mobile-dropdown-options each-item" %>
      </li>
      <li class="nav-item position-relative">
        <div class="dropdown-forward-container">
          <%= image_tag 'dropdown-forward.png', class: "dropdown-arrow" %>
        </div>
        <%= link_to "Influencers", "#", id: "mobile-nav-influencers", class: "nav-link mobile-dropdown-options each-item" %>
      </li>
      <li class="nav-item">
        <%= link_to "Make Up", products_path, class: "nav-link mobile-dropdown-options each-item" %>
      </li>
      <li class="nav-item">
        <%= link_to "Insider", insider_path, class: "nav-link mobile-dropdown-options each-item" %>
      </li>
      <li class="nav-item">
        <%= link_to "Video", videos_path, class: "nav-link mobile-dropdown-options each-item" %>
      </li>
      <!-- SHOWING ON MOBILE -->
    <% end %>
  </ul>
</div>

<!-- HIDDEN BRANDS BAR -->
<div id="mobile-nav-brands-menu" class="mobile-dropdown-options-brands collapse navbar-collapse">
  <ul class="navbar-nav mr-auto">
    <li id="back-to-menu-brands" class="back-to-menu">
      <div class="dropdown-back-container">
        <%= image_tag 'dropdown-back.png', class: "dropdown-arrow" %>
      </div>
      Brands</li>
      <%= link_to brands_path, class: "each-item" do %>
        <li class="nav-item each-item-dropdown">
          SEE ALL BRANDS
        </li>
      <% end %>
    <% @brands.each do |brand| %>
      <%= link_to brand_path(brand), class: "each-item" do %>

        <li class="nav-item each-item-dropdown">
          <%= brand.name %>
        </li>
      <% end %>
    <% end %>
  </ul>
</div>
<!-- HIDDEN BRANDS BAR -->

<!-- HIDDEN INFLUENCERS BAR -->
<div id="mobile-nav-influencers-menu" class="mobile-dropdown-options-influencers collapse navbar-collapse">
  <ul class="navbar-nav mr-auto">
    <li id="back-to-menu-influencers" class="back-to-menu">
      <div class="dropdown-back-container">
        <%= image_tag 'dropdown-back.png', class: "dropdown-arrow" %>
      </div>
      Influencers</li>
      <%= link_to influencers_path, class: "each-item" do %>
        <li class="nav-item each-item-dropdown">
          SEE ALL INFLUENCERS
        </li>
      <% end %>
    <% @influencers.each do |influencer| %>
      <%= link_to user_path(influencer), class: "each-item" do %>
        <li class="nav-item each-item-dropdown">
          <%= influencer.first_name.capitalize %> <%= influencer.last_name.capitalize %>
        </li>
      <% end %>
    <% end %>
  </ul>
</div>
<!-- HIDDEN INFLUENCERS BAR -->

<div class="navbar-submenu navbar-submenu-brands">
  <div class="navbar-submenu-container">
    <% @brands.each do |brand| %>
      <%= link_to brand_path(brand), class: "each-item" do %>
        <%= brand.name %>
      <% end %>
    <% end %>
  </div>
</div>
<div class="navbar-submenu navbar-submenu-influencers">
  <div class="navbar-submenu-container">
    <% @influencers.each do |influencer| %>
      <%= link_to user_path(influencer), class: "each-item" do %>
        <%= influencer.first_name %> <%= influencer.last_name %>
      <% end %>
    <% end %>
  </div>
</div>
<div class="navbar-submenu-underlay"></div>

<script>
  // WEB NAV
  navbarBrands = document.getElementById('navbar-brands');
  menuBrands = document.querySelector('.navbar-submenu-brands');
  navbarInfluencers = document.getElementById('navbar-influencers');
  menuInfluencers = document.querySelector('.navbar-submenu-influencers');
  subnavUnderlay = document.querySelector('.navbar-submenu-underlay');

  navbarBrands.addEventListener('mouseover', function() {
    menuBrands.style.display = "flex";
    subnavUnderlay.style.display = "block";
  });

  navbarBrands.addEventListener('mouseleave', function() {
    menuBrands.style.display = "none";
    subnavUnderlay.style.display = "none";
  });

  menuBrands.addEventListener('mouseover', function() {
    menuBrands.style.display = "flex";
    subnavUnderlay.style.display = "block";
  });

  menuBrands.addEventListener('mouseleave', function() {
    menuBrands.style.display = "none";
    subnavUnderlay.style.display = "none";
  });

  navbarInfluencers.addEventListener('mouseover', function() {
    menuInfluencers.style.display = "flex";
    subnavUnderlay.style.display = "block";
  });

  navbarInfluencers.addEventListener('mouseleave', function() {
    menuInfluencers.style.display = "none";
    subnavUnderlay.style.display = "none";
  });

  menuInfluencers.addEventListener('mouseover', function() {
    menuInfluencers.style.display = "flex";
    subnavUnderlay.style.display = "block";
  });

  menuInfluencers.addEventListener('mouseleave', function() {
    menuInfluencers.style.display = "none";
    subnavUnderlay.style.display = "none";
  });
  // WEB NAV

  // MOBILE NAV
  mobileNavBrands = document.getElementById('mobile-nav-brands');
  mobileNavInfluencers = document.getElementById('mobile-nav-influencers');
  mobileNavBrandsMenu = document.getElementById('mobile-nav-brands-menu');
  mobileNavInfluencersMenu = document.getElementById('mobile-nav-influencers-menu');
  backToMenuBrands = document.getElementById('back-to-menu-brands');
  backToMenuInfluencers = document.getElementById('back-to-menu-influencers');
  nav = document.getElementById('navbarSupportedContent');

  mobileNavBrands.addEventListener('click', function() {
    mobileNavBrandsMenu.style.left = 0;
    // nav.style.right = "100%";
  });

  mobileNavInfluencers.addEventListener('click', function() {
    mobileNavInfluencersMenu.style.left = 0;
    // nav.style.right = "100%";
  });

  backToMenuBrands.addEventListener('click', function() {
    mobileNavBrandsMenu.style.left = "100%";
    // nav.style.right = 0;
  });

  backToMenuInfluencers.addEventListener('click', function() {
    mobileNavInfluencersMenu.style.left = "100%";
    // nav.style.right = 0;
  });

  navbarToggler = document.getElementById('navbar-toggler');

  navbarToggler.addEventListener('click', function() {
    subnavUnderlay.classList.toggle('show-underlay');
    // setTimeout(function() {
    //   subnavUnderlay.classList.toggle('show-underlay');
    //   }, 300
    // );

    // subnavUnderlay.classList.toggle('show-underlay');
      // setTimeout(function() {
      //   navbarToggler.disabled = true;
      //   }, 1
      // );
    setTimeout(function() {
      mobileNavBrandsMenu.style.left = "100%";
      mobileNavInfluencersMenu.style.left = "100%";
      // navbarToggler.disabled = false;
      }, 300
    );
  });

  // subnavUnderlay.addEventListener('click', function() {
  //   subnavUnderlay.classList.toggle('show-underlay');
  //   navbarToggler.classList.toggle('collapsed');
  //   nav.classList.toggle('show');
  //   mobileNavBrands.classList.toggle('show');
  //   mobileNavInfluencers.classList.toggle('show');
  // });
  // MOBILE NAV
</script>
