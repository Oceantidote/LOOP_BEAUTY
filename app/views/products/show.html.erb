<div class="product-details-container">
  <div class="product-details">
    <div class="product-image-container">
      <div class="product-carousel">
        <% @product.shades.each do |shade| %>
          <div class="product-shade-image">
            <%= image_tag(url_for(shade.photos.first), onclick: "myFunction(this);", class: "item-image-thumbnail")  %>
          </div>
        <% end %>
      </div>
      <div class="product-main-image">
        <%= image_tag url_for(@product.shades.first.photos.first), id: "expandedImg", class: "myImg" %>
      </div>
    </div>
    <div class="product-info-container assistant">
    <%= simple_form_for([@product, BasketProduct.new(product: @product)]) do |f| %>
    <%= f.input :shade_id, as: :hidden, input_html: { value: @product.shades[0].id } %>

      <h5><%= @product.title %></h5>
      <hr>
      <p><strong>Title of shade</strong></p>
      <% colors = ['https://media.istockphoto.com/photos/green-cosmetic-clay-powder-texture-close-up-selective-focus-abstract-picture-id884603174', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS78bHnt2gbcBbyeTBBqVde3suKnkxZMtWfj8R1-IIdsnUlcj2PDQ', 'https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcR81aMOdrVMLvvEWZUPHPdNyc1Vv-OPn-EUKC9dlJzJDnd900bprQ'] %>
      <% num = 3 %>
      <div class="shades-container">
        <div class="row" style="margin: 0; width: 100%;">
            <!-- <div class="product-shade-cards-holder"> -->
              <% @product.shades.each_with_index do |shade, i| %>
                <div class="col-xs-3 col-sm-3" style="padding: 0 3px 0 0;">
                  <div class="product-shade-card <%= 'product-shade-card-selected' if i == 0 %>" data-shadeId="<%= shade.id %>" style="background-image: url(<%= url_for(shade.photos.first) %>)"></div>
                </div>
              <% end %>
            <!-- </div> -->
        </div>
      </div>
      <h5><%= humanized_money_with_symbol(@product.price) %></h5>
      <div class="card_ratings">
        <%= render 'shared/ratings', rating: @product.average_rating %>
        <p class="small-text"><%= @product.average_rating %> (<%= @product.total_reviews %> Reviews)</p>
      </div>
      <%#= link_to 'ADD TO BAG', '#', class: "primary-button" %>
      <%= f.submit 'ADD TO BAG', class: "primary-button" %>
    <% end %>
      <div class="product-details-section info-expand">
        <div class="product-details-title">
          <h6>Product details</h6>
          <i class="fas fa-plus pd-expand"></i>
        </div>
        <p class="product-details-text didot"><%= @product.details %></p>
      </div>
      <div class="about-the-brand-section info-expand">
        <div class="about-the-brand-title">
          <h6>About the brand</h6>
          <i class="fas fa-plus ab-expand"></i>
        </div>
        <p class="about-the-brand-text didot"><%= @product.brand.description %></p>
      </div>
      <div class="share-section">
        <h6>Share</h6>
        <div class="articles-link-icons">
          <%= link_to '#' do %>
            <i class="fab fa-facebook-f"></i>
          <% end %>
          <%= link_to '#' do %>
            <i class="fab fa-twitter"></i>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="product-insider-reviews-wrapper">
  <h2 class="insider-info-title text-center">Insider Reviews</h2>
  <div class="insider-review-container">
    <div class="row">
      <% if @product.insider_reviews.count == 0 %>
        <p class="text-center medium-margin width-100">There are no insider reviews yet</p>
      <% end %>
      <% @product.insider_reviews.each do |review| %>
        <div class="col-sm-12 col-md-4">
          <div class="insider-review-cards">
            <div class="insider-review-left">
              <div class="insider-review-image" style="background-image: url(<%= url_for(review.user.avatar_photo) %>)"></div>
              <h6><%= review.user.instagram %></h6>
            </div>
            <div class="insider-review-right">
              <div class="insider-review-text">
                <%= render 'shared/ratings', rating: review.rating %>
                <p class="didot"><%= review.review %></p>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="recommended-products-wrapper">
  <div class="recommended-products-header">
    <h2 class="insider-info-title text-center">Recommended Products</h2>
  </div>
  <div class="container">
    <div class="row">
      <% Product.all.sample(4).each do |product| %>
        <div class="col-xs-12 col-sm-6 col-md-3 d-flex justify-content-center" style="padding: 5px;">
          <div class="card-image-results">
            <div class="card">
              <%= link_to product_path(product) do %>
                <div class="card_image">
                  <%= link_to product_path(product) do %>
                    <%= image_tag url_for(product.shades.first.photos.first) %>
                  <% end %>
                </div>
              <% end %>
              <div class="card_header">
                <p><%= product.title %></p>
              </div>
              <div class="card_price-heart">
                <%= humanized_money_with_symbol(product.price) %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<div class="product-insider-reviews-wrapper">
  <h2 class="insider-info-title text-center">Customer Reviews</h2>
  <div class="insider-review-container">
    <div class="row">
      <% if @product.customer_reviews.count == 0 %>
        <p class="text-center medium-margin width-100">There are no customer reviews yet</p>
      <% end %>
      <% @product.customer_reviews.each do |review| %>
        <div class="col-xs-12 col-sm-6">
          <div class="customer-review-cards">
            <div class="customer-review-left">
              <h6><%= review.user.first_name.capitalize %></h6>
              <div class="boldest grey-font">
                <p><%= review.user.country %></p>
                <p>Age: 22-25</p>
                <p>Gender: Female</p>
              </div>
              <h6><%= review.created_at.strftime('%d.%m.%y') %></h6>
            </div>
            <div class="customer-review-right">
              <div class="customer-review-text">
                <%= render 'shared/ratings', rating: review.rating %>
                <p class="didot">"<%= review.review %>"</p>
                <p class="boldest">Yes,<span class="grey-font"> I would recommend this product</span></p>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>

    function myFunction(imgs) {
    // Get the expanded image
    expandImg = document.getElementById("expandedImg");
    // Get the image text
    imgText = document.getElementById("imgtext");
    // Use the same src in the expanded image as the image being clicked on from the grid
    expandImg.src = imgs.src;
    // Use the value of the alt attribute of the clickable image as text inside the expanded image
    // imgText.innerHTML = imgs.alt;
    // Show the container element (hidden with CSS)
    // expandImg.parentElement.style.display = "block";
  }

  details = document.querySelector(".product-details-title");
  detailsText = document.querySelector(".product-details-text");
  aboutBrand = document.querySelector(".about-the-brand-title");
  aboutBrandText = document.querySelector(".about-the-brand-text");
  expandIconProduct = document.querySelector(".pd-expand");
  expandIconBrand = document.querySelector(".ab-expand");

  details.addEventListener('click', function() {
    expandIconProduct.classList.toggle('fa-plus');
    expandIconProduct.classList.toggle('fa-minus');
    detailsText.classList.toggle('show-text');
  });

  aboutBrand.addEventListener('click', function() {
    expandIconBrand.classList.toggle('fa-plus');
    expandIconBrand.classList.toggle('fa-minus');
    aboutBrandText.classList.toggle('show-text');

  });
</script>
