<div class="tutorial-show-title-content">
  <%= link_to 'See all tutorials', influencer_video_path, class: "web-tutorials-link" %>
  <h2 class="insider-info-title text-center"><%= @tutorial.title %></h2>
  <div class="previous-next-tutorial">
    <div class="previous">
      <%= image_tag 'dropdown-forward.png', width: 10, style: "transform: rotate(180deg)" %>
      <%= link_to 'Previous', '#' %>
    </div>
    <span class="previous-next-seperator"><strong style="margin: 0 5px;">|</strong></span>
    <div class="next">
      <%= link_to 'Next', '#' %>
      <%= image_tag 'dropdown-forward.png', width: 10 %>
    </div>
  </div>
</div>
<div class="tutorial-show-video-banner">
  <%= video_tag url_for(@tutorial.video), style: "width: 100%", id: "tutorial-show-video" %>
  <div class="video-overlay">
    <%= image_tag 'play-button.png', class: "video-home-play-button", width: 80 %>
  </div>
</div>
<%= link_to 'See all tutorials', influencer_video_path, class: "mobile-tutorials-link" %>

<div class="featured-products-wrapper">
  <div class="featured-products-header">
    <div class="tutorial-spacer" style="width: 150px;"></div>
    <h2 class="insider-info-title text-center">Featured Products</h2>
    <%= link_to 'Shop more products', products_path, class: "web-tutorials-link" %>
  </div>
  <div class="container">
    <div class="row">
      <% @tutorial.products.first(4).each do |product| %>
        <div class="col-xs-12 col-sm-6 col-md-3 d-flex justify-content-center" style="padding: 5px;">
          <div class="card-image-results">
            <div class="card">
              <%= link_to product_path(product) do %>
                <div class="card_image">
                  <%= link_to product_path(product) do %>
                    <%= image_tag url_for(product.shades.first.photos.first) %>
                  <% end %>
                </div>
              <% end %>
              <div class="card_header">
                <p><%= product.title %></p>
              </div>
              <div class="card_price-heart">
                <%= humanized_money_with_symbol(product.price) %>
              </div>
              <div class="card_ratings">
                <% if product.average_rating == 0 %>
                 <% 5.times do %>
                  <p><i class="far fa-star"></i></p>
                  <% end %>
                 <p>(0) Reviews</p>
                <% else  %>
                  <% product.average_rating.times do %>
                    <p><i class="fas fa-star"></i></p>
                  <% end %>
                  <p><%= product.total_reviews %></p>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <%= link_to 'Shop more products', products_path, class: "mobile-tutorials-link" %>
</div>
<div class="similar-tutorials-wrapper">
  <div class="similar-tutorials-header">
    <div class="tutorial-spacer" style="width: 150px;"></div>
    <h2 class="insider-info-title text-center">You'll also love</h2>
    <%= link_to 'View more tutorials', '#', class: "web-tutorials-link" %>
  </div>
  <div class="container">
    <div class="row">
      <% @tutorials.sample(4).each do |tutorial| %>
        <div class="col-xs-12 col-md-6 col-lg-3">
          <%= link_to tutorial_path(tutorial), class: "video-card-link card-link" do %>
            <div class="homepage-video-card">
              <div class="video-holder" style="background-image: url(<%= url_for(tutorial.cover_photo) %>)">
                <%= image_tag 'play-button.png', class: "play-button", width: 80 %>
              </div>
              <div class="homepage-video-card-text">
                <p class="video-card-text-title">by <%= tutorial.user.instagram %></p>
                <p class="video-card-text-content"><%= tutorial.title %></p>
              </div>
            </div>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>
  <%= link_to 'View more tutorials', '#', class: "mobile-tutorials-link" %>
</div>

<% if current_user&.admin? && @tutorial.status == "pending" || @tutorial.status == "rejected" %>
  <h3>Current Status: <%= @tutorial.status %></h3>
  <%= link_to "Approve", approve_admin_tutorial_path(@tutorial), method: :patch %>
  <%= simple_form_for @tutorial, url: reject_admin_tutorial_path, method: :patch do |f| %>
    <%= f.input :rejection_message%>
    <%= f.submit "Reject" %>
  <% end %>
<% end %>

<script>
  videoOverlay = document.querySelector('.video-overlay');
  video = document.getElementById('tutorial-show-video');

  videoOverlay.addEventListener('click', function() {
    videoOverlay.style.display = "none";
    video.play();
    video.controls = 'true';
  })
</script>
